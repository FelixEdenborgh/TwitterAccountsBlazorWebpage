@page "/skynewsarticles"
@using TwitterAccountsBlazorWebpage.Models
@using TwitterAccountsBlazorWebpage.Rss_Feed_Import
@inject ArticlesRssFeedService RssFeedService

<h3>news.sky.com/world</h3>

<div class="container">
    <div class="row">
        <div class="col-md-6">
            <h4>Articles</h4>
            @foreach (var article in articles)
            {
                <div class="article-box mb-4">
                    <h5>@article.Title</h5>
                    <div class="article-media">
                        @if (!string.IsNullOrEmpty(article.MediaUrl))
                        {
                            <img src="@article.MediaUrl" alt="@article.Title" class="img-fluid mb-2" />
                        }
                    </div>
                    <div class="article-content">
                        <p>@(new MarkupString(article.Summary))</p>
                    </div>
                    <div class="article-link">
                        <a href="@article.Link" target="_blank">Read more...</a>
                    </div>
                </div>
            }
        </div>
        <div class="col-md-6">
            <h4>Videos</h4>
            @foreach (var video in videos)
            {
                <div class="video-box mb-4">
                    <h5>@video.Title</h5>
                    <div class="video-media">
                        @if (!string.IsNullOrEmpty(video.MediaUrl))
                        {
                            <video controls class="img-fluid mb-2">
                                <source src="@video.MediaUrl" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                        }
                    </div>
                    <div class="video-content">
                        <p>@(new MarkupString(video.Summary))</p>
                    </div>
                    <div class="video-link">
                        <a href="@video.Link" target="_blank">Watch video...</a>
                    </div>
                </div>
            }
        </div>
    </div>
</div>

@code {
    private List<FeedItem> articles = new();
    private List<FeedItem> videos = new();
    private string rssFeedUrl = "https://rss.app/feeds/bEKmytFzulOLq192.xml"; // xml feed

    protected override void OnInitialized()
    {
        var feedItems = RssFeedService.GetFeedItems(rssFeedUrl);
        articles = RssFeedService.GetArticles(feedItems);
        videos = RssFeedService.GetVideos(feedItems);
    }
}